---
description:
  Automates the running of cline-metrics tool for analysis on new projects to assess development value and ROI.
author: Cline
version: 1.0
tags: ['automation', 'cline-metrics', 'analysis', 'roi']
globs: ['*']
---

# Rule: Automating cline-metrics Analysis for New Projects

## Objective

To automate the execution of the `cline-metrics` tool whenever a new project is initiated or at regular intervals during
project development, providing continuous assessment of development value, code quality, and financial ROI based on
Cline session data.

## Trigger

This rule **MUST** be activated in the following scenarios:

- When a new project is created or initialized within Cline's scope.
- At the end of each significant development phase or milestone (e.g., after completing a major feature or sprint).
- Periodically, such as on a weekly basis, if the project is ongoing and no milestone has triggered an analysis
  recently.

## Process

Cline **MUST** follow these steps to ensure `cline-metrics` is run effectively on new or ongoing projects:

### 1. Prerequisite Check

- **MUST** verify that Python 3.8 or higher is installed on the system using the command `python --version`.
- If Python version is insufficient, **MUST** notify the user and suggest installation or update to meet the
  requirement.

### 2. Ensure cline-metrics Script Availability

- **MUST** check if the `analyze_cline_sessions.py` script is present in the current working directory or a designated
  tools directory.
- If not present, **MUST** download the script from the official source (e.g.,
  `https://raw.githubusercontent.com/SaharCarmel/cline-metrics/main/analyze_cline_sessions.py`) using a command like
  `curl -o analyze_cline_sessions.py https://raw.githubusercontent.com/SaharCarmel/cline-metrics/main/analyze_cline_sessions.py`.
- If download fails, **MUST** ask the user for assistance in obtaining the script or provide an alternative method.

### 3. Locate Cline Session Data Path

- **MUST** attempt to auto-detect the Cline session data path based on the operating system:
  - Windows: `~/AppData/Roaming/Code/User/globalStorage/saoudrizwan.claude-dev/tasks` or
    `~/AppData/Roaming/VSCodium/User/globalStorage/saoudrizwan.claude-dev/tasks`.
  - macOS: `~/Library/Application Support/Code/User/globalStorage/saoudrizwan.claude-dev/tasks`.
  - Linux: `~/.config/Code/User/globalStorage/saoudrizwan.claude-dev/tasks`.
- If auto-detection fails or the path does not exist, **MUST** ask the user to provide the correct path to the session
  data.

### 4. Run cline-metrics Analysis

- **MUST** execute the `cline-metrics` tool using the command `python analyze_cline_sessions.py` if auto-detection is
  expected to work.
- If a custom path is required or provided, **MUST** use
  `python analyze_cline_sessions.py --path "correct/path/to/session/data"`.
- Optionally, **MAY** use parameters like `--limit N` to analyze only the N most recent sessions if the project scope or
  performance requires it.
- **MUST** ensure the command is run in a safe manner without modifying system files, setting `requires_approval` to
  `false`.

### 5. Review and Report Results

- **MUST** review the output report generated by `cline-metrics`, which includes overall statistics, financial analysis,
  code output analysis, engineering time value, and ROI metrics.
- **MUST** present a summary of key findings to the user, highlighting total time spent, API costs, estimated value
  created, and ROI ratio.
- **MUST** store the full report or key metrics in the project's `memory-bank` under `progress.md` or a dedicated
  analysis file for future reference.

### 6. Handle Issues and Exceptions

- If the tool fails to run due to path issues, missing script, or other errors, **MUST** use the `ask_followup_question`
  tool to request user input or clarification.
- **MUST** document any issues encountered and resolutions in the project's `memory-bank/raw_reflection_log.md` as per
  the `cline-continuous-improvement.md` guidelines.

## Integration with Project Workflow

- **MUST** integrate `cline-metrics` analysis into the project initialization workflow, ensuring it runs automatically
  after project setup.
- **MUST** schedule periodic analysis (e.g., weekly) by prompting the user or setting a reminder in the project
  documentation if continuous monitoring is desired.
- **MUST** link the analysis results to project progress tracking, updating relevant files like `progress.md` in the
  `memory-bank` to reflect development value and efficiency metrics.

## User Notification

- **MUST** inform the user before running the analysis with a message like: "As per the `cline-metrics-automation` rule,
  I will now run the `cline-metrics` tool to analyze session data for this new project. The analysis will provide
  insights into development value and ROI."
- **MUST** allow the user to opt-out or specify a custom schedule if they prefer not to run the analysis at the
  triggered time.

## Documentation and Reflection

- **MUST** adhere to the `cline-continuous-improvement.md` protocol by logging the results, learnings, and any
  difficulties encountered during the `cline-metrics` analysis in `memory-bank/raw_reflection_log.md`.
- **MUST** consolidate valuable insights (e.g., ROI trends, efficiency metrics) into
  `memory-bank/consolidated_learnings.md` during periodic reviews.

## User Customization Options

- **MUST** provide options for users to customize the frequency of `cline-metrics` analysis (e.g., daily, weekly, per
  milestone) by prompting for preferences during the initial project setup or through a configuration file.
- **MUST** offer an opt-out mechanism allowing users to disable automated analysis if desired, with a prompt like:
  "Would you like to disable automated `cline-metrics` analysis for this project?"
- **MAY** allow users to specify custom parameters for `cline-metrics` (e.g., `--limit N` for session count) through a
  settings interface or project-specific configuration.

## Final Note

This rule ensures that Cline provides ongoing value assessment for new and existing projects by automating the use of
`cline-metrics`. By following these steps, Cline will maintain a high level of transparency and efficiency tracking,
aiding in project management and decision-making.
